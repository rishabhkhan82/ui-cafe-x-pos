<!-- Global Loading Overlay -->
<div *ngIf="isLoading" class="fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-center justify-center">
  <div class="bg-transparent rounded-xl p-8 flex flex-col items-center space-y-4 max-w-sm mx-4">
    <!-- Professional Spinner -->
    <div class="relative">
      <div class="w-12 h-12 border-4 border-red-200 dark:border-red-800 rounded-full animate-spin border-t-red-500"></div>
      <div class="absolute inset-0 flex items-center justify-center">
        <i class="fas fa-coffee text-red-500 animate-spin text-xl"></i>
      </div>
    </div>
    <!-- Loading Text -->
    <div class="text-center">
      <div class="flex items-center justify-center space-x-2 mb-3">
        <span class="text-lg font-semibold text-gray-900 dark:text-white animate-pulse">Loading...</span>
      </div>
      <!-- <p class="text-sm text-gray-600 dark:text-gray-400">Please wait while we process your request</p> -->
    </div>
  </div>
</div>

<!-- Add toast notifier at the very top -->
<app-toast-notifier></app-toast-notifier>

<!-- Add confirmation dialog -->
<app-confirmation-dialog></app-confirmation-dialog>

<!-- POS Header - Only show when logged in -->
<header *ngIf="isLoggedIn" class="fixed top-0 left-0 right-0 z-50 bg-white dark:bg-gradient-to-r dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 text-gray-900 dark:text-white shadow-lg border-b border-gray-200 dark:border-gray-700">
  <div class="px-4 py-3">
    <div class="flex items-center justify-between">
      <!-- Logo & Brand -->
      <div class="flex items-center space-x-4">
        <div class="flex items-center space-x-3">
          <div class="w-10 h-10 bg-gradient-to-br from-red-500 to-red-600 rounded-lg flex items-center justify-center shadow-lg boxFlip">
            <i class="fas fa-coffee text-white text-lg"></i>
          </div>
          <div>
            <h1 class="text-xl font-bold tracking-wide">CafeX POS</h1>
            <p class="text-xs text-gray-500 dark:text-gray-500">Multi-Tenant SaaS System</p>
          </div>
        </div>
      </div>

      <!-- Navigation Menu -->
      <div class="flex-1 flex justify-end mr-4">
        <app-navigation-menu></app-navigation-menu>
      </div>

      <!-- Right Side Actions -->
      <div class="flex items-center space-x-4">
        <!-- Current Date/Time -->
        <div class="hidden md:flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400">
          <i class="fas fa-clock"></i>
          <span>{{ currentDateTime }}</span>
        </div>

        <!-- Theme Toggle -->
        <button (click)="toggleTheme()" class="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors" title="Toggle Theme">
          <i class="fas fa-moon text-gray-600 dark:text-gray-400 dark:hidden"></i>
          <i class="fas fa-sun text-yellow-400 hidden dark:inline"></i>
        </button>

        <!-- Notifications -->
        <button class="relative p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
          <i class="fas fa-bell text-gray-600 dark:text-gray-400"></i>
          <span class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"></span>
        </button>

        <!-- User Profile -->
        <div class="flex items-center space-x-3 border-l border-gray-300 dark:border-gray-600 pl-4">
          <div class="text-right">
            <p class="text-sm font-medium text-gray-900 dark:text-white">{{ currentUser?.name || 'User' }}</p>
            <p class="text-xs text-gray-500 dark:text-gray-400">{{ currentUser?.role?.replace('_', ' ') || 'Role' }}</p>
          </div>
          <div class="relative">
            <img [src]="currentUser?.avatar || 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face'"
                 alt="Profile"
                 class="w-10 h-10 rounded-full border-2 border-gray-300 dark:border-gray-500">
            <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 border-2 border-white dark:border-gray-900 rounded-full"></div>
          </div>
          <button (click)="logout()" class="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors" title="Logout">
            <i class="fas fa-sign-out-alt text-gray-600 dark:text-gray-400"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</header>

<!-- Main Content Area -->
<main class="flex-1 overflow-y-auto" [style.height.px]="isLoggedIn ? 'calc(100vh - 140px)' : '100vh'" [style.padding-top.px]="isLoggedIn ? 68 : 0" [style.padding-bottom.px]="isLoggedIn ? 44 : 0">
  <router-outlet></router-outlet>
</main>

<!-- POS Footer - Only show when logged in -->
<footer *ngIf="isLoggedIn" class="fixed bottom-0 left-0 right-0 z-40 bg-gray-50 dark:bg-gray-900 text-gray-600 dark:text-gray-400 border-t border-gray-200 dark:border-gray-700">
  <div class="px-4 py-3">
    <div class="flex items-center justify-between text-sm">
      <div class="flex items-center space-x-6">
        <span>Â© 2025 CafeX POS v1.0.0</span>
        <span class="text-gray-400 dark:text-gray-600">|</span>
        <span>System Status: <span class="text-green-600 dark:text-green-400 blink">Online</span></span>
        <span class="text-gray-400 dark:text-gray-600">|</span>
        <span>Last Backup: {{ lastBackupTime }}</span>
      </div>
      <div class="flex items-center space-x-4">
        <button class="hover:text-gray-900 dark:hover:text-white transition-colors">
          <i class="fas fa-question-circle mr-1"></i>Help
        </button>
        <button class="hover:text-gray-900 dark:hover:text-white transition-colors">
          <i class="fas fa-cog mr-1"></i>Settings
        </button>
        <button class="hover:text-gray-900 dark:hover:text-white transition-colors">
          <i class="fas fa-shield-alt mr-1"></i>Security
        </button>
      </div>
    </div>
  </div>
</footer>
