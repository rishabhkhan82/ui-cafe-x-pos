<div class="p-6">
  <div class="mb-6">
    <div class="flex justify-between items-center">
      <div>
        <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Integrations</h1>
        <p class="text-gray-600 dark:text-gray-300">Connect third-party services and expand platform capabilities</p>
      </div>
      <button
        (click)="showAddIntegration()"
        class="px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center space-x-2">
        <i class="fas fa-plus"></i>
        <span>Add Integration</span>
      </button>
    </div>
  </div>

  <!-- Integration Metrics -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <div class="pos-card rounded-2xl p-6">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm text-gray-500 dark:text-gray-400">Total Integrations</p>
          <h3 class="text-3xl font-bold text-gray-900 dark:text-white">{{ metrics.totalIntegrations }}</h3>
          <p class="text-sm text-green-600 dark:text-green-400">{{ metrics.activeIntegrations }} active</p>
        </div>
        <div class="w-12 h-12 rounded-xl bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center text-blue-500">
          <i class="fas fa-plug text-xl"></i>
        </div>
      </div>
    </div>

    <div class="pos-card rounded-2xl p-6">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm text-gray-500 dark:text-gray-400">Active Connections</p>
          <h3 class="text-3xl font-bold text-gray-900 dark:text-white">{{ metrics.activeIntegrations }}</h3>
          <p class="text-sm text-green-600 dark:text-green-400">{{ calculateSuccessRate() }}% success rate</p>
        </div>
        <div class="w-12 h-12 rounded-xl bg-green-50 dark:bg-green-900/30 flex items-center justify-center text-green-500">
          <i class="fas fa-check-circle text-xl"></i>
        </div>
      </div>
    </div>

    <div class="pos-card rounded-2xl p-6">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm text-gray-500 dark:text-gray-400">Failed Syncs</p>
          <h3 class="text-3xl font-bold text-gray-900 dark:text-white">{{ metrics.failedSyncs }}</h3>
          <p class="text-sm text-red-600 dark:text-red-400">Last 24 hours</p>
        </div>
        <div class="w-12 h-12 rounded-xl bg-red-50 dark:bg-red-900/30 flex items-center justify-center text-red-500">
          <i class="fas fa-exclamation-triangle text-xl"></i>
        </div>
      </div>
    </div>

    <div class="pos-card rounded-2xl p-6">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm text-gray-500 dark:text-gray-400">Data Transferred</p>
          <h3 class="text-3xl font-bold text-gray-900 dark:text-white">{{ formatBytes(metrics.dataTransferred) }}</h3>
          <p class="text-sm text-blue-600 dark:text-blue-400">This month</p>
        </div>
        <div class="w-12 h-12 rounded-xl bg-purple-50 dark:bg-purple-900/30 flex items-center justify-center text-purple-500">
          <i class="fas fa-database text-xl"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- Filters and Search -->
  <div class="pos-card rounded-2xl p-6 mb-6">
    <div class="flex flex-wrap gap-4 items-center">
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Category</label>
        <select
          [(ngModel)]="selectedCategory"
          (change)="filterIntegrations()"
          class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white">
          <option value="all">All Categories</option>
          <option value="payment">Payment</option>
          <option value="delivery">Delivery</option>
          <option value="communication">Communication</option>
          <option value="analytics">Analytics</option>
          <option value="social">Social</option>
          <option value="pos">POS</option>
        </select>
      </div>

      <div class="flex-1 min-w-64">
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Search Integrations</label>
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (input)="filterIntegrations()"
          placeholder="Search by name, provider, or description..."
          class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white">
      </div>
    </div>
  </div>

  <!-- Add Integration Form -->
  <div *ngIf="showAddIntegrationForm" class="pos-card rounded-2xl p-6 mb-6 border-2 border-dashed border-gray-300 dark:border-gray-600">
    <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Add New Integration</h3>
    <form (ngSubmit)="addIntegration()" class="space-y-4">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Integration Name</label>
          <input
            type="text"
            [(ngModel)]="newIntegration.name"
            name="name"
            required
            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white"
            placeholder="Enter integration name">
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Category</label>
          <select
            [(ngModel)]="newIntegration.category"
            name="category"
            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white">
            <option value="payment">Payment</option>
            <option value="delivery">Delivery</option>
            <option value="communication">Communication</option>
            <option value="analytics">Analytics</option>
            <option value="social">Social</option>
            <option value="pos">POS</option>
          </select>
        </div>
        <div class="md:col-span-2">
          <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Description</label>
          <textarea
            [(ngModel)]="newIntegration.description"
            name="description"
            required
            rows="3"
            class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white"
            placeholder="Describe the integration"></textarea>
        </div>
      </div>
      <div class="flex justify-end space-x-3">
        <button
          type="button"
          (click)="cancelAddIntegration()"
          class="px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
          Cancel
        </button>
        <button
          type="submit"
          class="px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors">
          Add Integration
        </button>
      </div>
    </form>
  </div>

  <!-- Integrations Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
    <div
      *ngFor="let integration of filteredIntegrations"
      class="pos-card rounded-2xl p-6 hover:shadow-lg transition-all duration-200">
      <div class="flex items-start justify-between mb-4">
        <div class="flex items-center space-x-4">
          <div class="w-12 h-12 rounded-xl bg-gray-100 dark:bg-gray-700 flex items-center justify-center">
            <i [class]="integration.icon" class="text-gray-600 dark:text-gray-300 text-xl"></i>
          </div>
          <div>
            <h3 class="font-bold text-gray-900 dark:text-white">{{ integration.name }}</h3>
            <p class="text-sm text-gray-500 dark:text-gray-400">{{ integration.provider }}</p>
          </div>
        </div>
        <div class="flex items-center space-x-2">
          <span
            [class]="getStatusColor(integration.status)"
            class="px-2 py-1 text-xs rounded-full font-medium flex items-center space-x-1">
            <i [class]="getStatusIcon(integration.status)" class="text-xs"></i>
            <span>{{ integration.status | titlecase }}</span>
          </span>
        </div>
      </div>

      <p class="text-sm text-gray-600 dark:text-gray-300 mb-4">{{ integration.description }}</p>

      <!-- Category and Features -->
      <div class="mb-4">
        <span
          [class]="getCategoryColor(integration.category)"
          class="inline-block px-2 py-1 text-xs rounded-full font-medium mb-2">
          {{ integration.category | titlecase }}
        </span>
        <div class="flex flex-wrap gap-1">
          <span
            *ngFor="let feature of integration.features.slice(0, 3)"
            class="px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 text-xs rounded-full">
            {{ feature }}
          </span>
          <span
            *ngIf="integration.features.length > 3"
            class="px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 text-xs rounded-full">
            +{{ integration.features.length - 3 }} more
          </span>
        </div>
      </div>

      <!-- Sync Status -->
      <div *ngIf="integration.lastSync" class="flex items-center justify-between text-sm mb-4">
        <div class="flex items-center space-x-2">
          <i
            [class]="getSyncStatusColor(integration.syncStatus)"
            class="fas fa-circle text-xs"></i>
          <span class="text-gray-500 dark:text-gray-400">Last sync: {{ formatDate(integration.lastSync) }}</span>
        </div>
        <span
          [class]="getSyncStatusColor(integration.syncStatus)"
          class="font-medium">
          {{ integration.syncStatus | titlecase }}
        </span>
      </div>

      <!-- Pricing -->
      <div *ngIf="integration.pricing" class="flex items-center justify-between text-sm mb-4">
        <span class="text-gray-500 dark:text-gray-400">Pricing:</span>
        <span class="font-medium text-gray-900 dark:text-white">
          {{ integration.pricing.cost === 0 ? 'Free' : 'â‚¹' + integration.pricing.cost + '/' + integration.pricing.billingCycle }}
        </span>
      </div>

      <!-- Action Buttons -->
      <div class="flex space-x-2">
        <button
          *ngIf="integration.status === 'disconnected'"
          (click)="connectIntegration(integration)"
          class="flex-1 px-3 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors">
          Connect
        </button>
        <button
          *ngIf="integration.status === 'connected'"
          (click)="testIntegration(integration)"
          class="flex-1 px-3 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors">
          Test
        </button>
        <button
          *ngIf="integration.status === 'connected'"
          (click)="configureIntegration(integration)"
          class="px-3 py-2 bg-gray-600 text-white text-sm rounded-lg hover:bg-gray-700 transition-colors">
          Configure
        </button>
        <button
          *ngIf="integration.status === 'connected'"
          (click)="disconnectIntegration(integration)"
          class="px-3 py-2 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 transition-colors">
          Disconnect
        </button>
      </div>
    </div>
  </div>

  <!-- Integration Categories Overview -->
  <div class="pos-card rounded-2xl p-6 mt-8">
    <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Integration Categories</h3>
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
      <div class="text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
        <div class="w-12 h-12 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mx-auto mb-2">
          <i class="fas fa-credit-card text-blue-600 dark:text-blue-400"></i>
        </div>
        <div class="text-sm font-medium text-blue-900 dark:text-blue-100">Payment</div>
        <div class="text-xs text-blue-700 dark:text-blue-300">{{ getIntegrationsByCategory('payment').length }} integrations</div>
      </div>

      <div class="text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
        <div class="w-12 h-12 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center mx-auto mb-2">
          <i class="fas fa-truck text-green-600 dark:text-green-400"></i>
        </div>
        <div class="text-sm font-medium text-green-900 dark:text-green-100">Delivery</div>
        <div class="text-xs text-green-700 dark:text-green-300">{{ getIntegrationsByCategory('delivery').length }} integrations</div>
      </div>

      <div class="text-center p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
        <div class="w-12 h-12 rounded-lg bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center mx-auto mb-2">
          <i class="fas fa-comments text-purple-600 dark:text-purple-400"></i>
        </div>
        <div class="text-sm font-medium text-purple-900 dark:text-purple-100">Communication</div>
        <div class="text-xs text-purple-700 dark:text-purple-300">{{ getIntegrationsByCategory('communication').length }} integrations</div>
      </div>

      <div class="text-center p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg">
        <div class="w-12 h-12 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center mx-auto mb-2">
          <i class="fas fa-chart-bar text-orange-600 dark:text-orange-400"></i>
        </div>
        <div class="text-sm font-medium text-orange-900 dark:text-orange-100">Analytics</div>
        <div class="text-xs text-orange-700 dark:text-orange-300">{{ getIntegrationsByCategory('analytics').length }} integrations</div>
      </div>

      <div class="text-center p-4 bg-pink-50 dark:bg-pink-900/20 rounded-lg">
        <div class="w-12 h-12 rounded-lg bg-pink-100 dark:bg-pink-900/30 flex items-center justify-center mx-auto mb-2">
          <i class="fas fa-share-alt text-pink-600 dark:text-pink-400"></i>
        </div>
        <div class="text-sm font-medium text-pink-900 dark:text-pink-100">Social</div>
        <div class="text-xs text-pink-700 dark:text-pink-300">{{ getIntegrationsByCategory('social').length }} integrations</div>
      </div>

      <div class="text-center p-4 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg">
        <div class="w-12 h-12 rounded-lg bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center mx-auto mb-2">
          <i class="fas fa-cash-register text-indigo-600 dark:text-indigo-400"></i>
        </div>
        <div class="text-sm font-medium text-indigo-900 dark:text-indigo-100">POS</div>
        <div class="text-xs text-indigo-700 dark:text-indigo-300">{{ getIntegrationsByCategory('pos').length }} integrations</div>
      </div>
    </div>
  </div>
</div>
