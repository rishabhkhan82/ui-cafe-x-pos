import{a as N}from"./chunk-EFGL7IQN.js";import{a as D}from"./chunk-LVGQPJ4G.js";import{l as I,m as E,q as T}from"./chunk-E6ASQAUT.js";import{$a as g,Ea as r,Sa as u,Va as p,Ya as y,Z as _,Za as a,_a as i,ba as k,cb as b,fb as v,gb as c,ka as x,kb as s,la as f,lb as h,mb as d,nb as O,ub as C,z as w}from"./chunk-7EVLTLXU.js";function M(o,t){if(o&1){let e=b();a(0,"button",8),v("click",function(){let l=x(e).$implicit,m=c();return f(m.setActiveStatus(l.key))}),g(1,"i",9),s(2),a(3,"span",10),s(4),i()()}if(o&2){let e=t.$implicit,n=c();y(n.getStatusButtonClass(e.key)),r(),y(e.icon),r(),d(" ",e.label," "),r(),y(n.getStatusCountClass(e.key)),r(),d(" ",n.getOrdersByStatus(e.key).length," ")}}function V(o,t){if(o&1&&(a(0,"div",41),s(1),i()),o&2){let e=c().$implicit,n=c();r(),d(" Est: ",n.formatTime(e.estimatedReadyTime)," ")}}function $(o,t){if(o&1&&(a(0,"div",47),g(1,"i",48),s(2),i()),o&2){let e=c().$implicit;r(2),d("",e.specialInstructions," ")}}function A(o,t){if(o&1&&(a(0,"div",42)(1,"div",43)(2,"span",44),s(3),i(),u(4,$,3,1,"div",45),i(),a(5,"span",46),s(6),i()()),o&2){let e=t.$implicit;r(3),O("",e.quantity,"x ",e.menuItemName,""),r(),p("ngIf",e.specialInstructions),r(2),d("\u20B9",e.totalPrice,"")}}function F(o,t){if(o&1){let e=b();a(0,"button",49),v("click",function(){x(e);let l=c().$implicit,m=c();return f(m.updateOrderStatus(l,m.getNextStatus(l.status)))}),g(1,"i",50),s(2),i()}if(o&2){let e=c().$implicit,n=c();r(2),d("",n.getNextStatusLabel(e.status)," ")}}function B(o,t){if(o&1){let e=b();a(0,"button",51),v("click",function(){x(e);let l=c().$implicit,m=c();return f(m.markOrderServed(l))}),g(1,"i",52),s(2,"Served "),i()}}function j(o,t){if(o&1){let e=b();a(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14)(4,"span",15),s(5),i(),a(6,"span",16),s(7),i()(),a(8,"div",17)(9,"div",18),s(10),i(),a(11,"div",19),s(12),i()()(),a(13,"div",20)(14,"span"),s(15),i(),a(16,"span",21),s(17),i()(),a(18,"div",22)(19,"div",14),g(20,"i",23),a(21,"span",24),s(22),i()(),u(23,V,2,1,"div",25),i()(),a(24,"div",26)(25,"div",27),u(26,A,7,4,"div",28),i(),a(27,"div",29)(28,"div",30)(29,"span"),s(30),i(),a(31,"span",31),s(32),i()()()(),a(33,"div",32)(34,"div",33)(35,"div",14),u(36,F,3,1,"button",34)(37,B,3,0,"button",35),i(),a(38,"div",36)(39,"button",37),v("click",function(){let l=x(e).$implicit,m=c();return f(m.viewOrderDetails(l))}),g(40,"i",38),i(),a(41,"button",39),v("click",function(){let l=x(e).$implicit,m=c();return f(m.printOrder(l))}),g(42,"i",40),i()()()()()}if(o&2){let e=t.$implicit,n=c();y(n.getOrderCardClass(e)),r(),y(n.getOrderHeaderClass(e)),r(4),d("#",e.id.split("-").pop(),""),r(),y(n.getPriorityBadgeClass(e)),r(),d(" ",n.getOrderPriority(e)," "),r(3),h(e.orderType==="dine_in"?"Table":"Takeaway"),r(2),h(e.tableNumber||"T/A"),r(3),h(e.customerName),r(2),h(n.formatTime(e.createdAt)),r(5),h(n.getElapsedTime(e.createdAt)),r(),p("ngIf",e.estimatedReadyTime),r(3),p("ngForOf",e.items),r(4),d("Total: \u20B9",e.totalAmount,""),r(2),d("",e.items.length," items"),r(4),p("ngIf",n.canMoveToNextStatus(e)),r(),p("ngIf",e.status==="ready")}}function P(o,t){if(o&1&&(a(0,"div",53)(1,"div",54)(2,"div",55),g(3,"i",56),i(),a(4,"h3",57),s(5),i(),a(6,"p",58),s(7,"Orders will appear here when customers place them."),i()()()),o&2){let e=c();r(5),d("No orders in ",e.activeStatusLabel,"")}}function R(o,t){if(o&1&&(a(0,"p")(1,"strong"),s(2,"Est. Ready:"),i(),s(3),i()),o&2){let e=c(2);r(3),d(" ",e.formatTime(e.selectedOrder.estimatedReadyTime),"")}}function L(o,t){if(o&1&&(a(0,"div",83),s(1),i()),o&2){let e=c().$implicit;r(),d(" Note: ",e.specialInstructions," ")}}function U(o,t){if(o&1&&(a(0,"div",79)(1,"div",43)(2,"div",80),s(3),i(),u(4,L,2,1,"div",81),i(),a(5,"div",17)(6,"div",19),s(7),i(),a(8,"div",82),s(9),i()()()),o&2){let e=t.$implicit;r(3),O("",e.quantity,"x ",e.menuItemName,""),r(),p("ngIf",e.specialInstructions),r(3),d("\u20B9",e.totalPrice,""),r(2),d("\u20B9",e.unitPrice," each")}}function q(o,t){if(o&1){let e=b();a(0,"button",84),v("click",function(){x(e);let l=c(2);return l.updateOrderStatus(l.selectedOrder,l.getNextStatus(l.selectedOrder.status)),f(l.closeOrderDetails())}),g(1,"i",85),s(2),i()}if(o&2){let e=c(2);r(2),d("",e.getNextStatusLabel(e.selectedOrder.status)," ")}}function z(o,t){if(o&1){let e=b();a(0,"div",59)(1,"div",60)(2,"div",61)(3,"div",62)(4,"h2",63),s(5),i(),a(6,"button",64),v("click",function(){x(e);let l=c();return f(l.closeOrderDetails())}),g(7,"i",65),i()(),a(8,"div",66)(9,"div")(10,"h3",67),s(11,"Customer Details"),i(),a(12,"p")(13,"strong"),s(14,"Name:"),i(),s(15),i(),a(16,"p")(17,"strong"),s(18,"Table:"),i(),s(19),i(),a(20,"p")(21,"strong"),s(22,"Type:"),i(),s(23),i(),a(24,"p")(25,"strong"),s(26,"Status:"),i(),a(27,"span"),s(28),i()()(),a(29,"div")(30,"h3",67),s(31,"Order Details"),i(),a(32,"p")(33,"strong"),s(34,"Order Time:"),i(),s(35),i(),a(36,"p")(37,"strong"),s(38,"Elapsed:"),i(),s(39),i(),u(40,R,4,1,"p",68),a(41,"p")(42,"strong"),s(43,"Items:"),i(),s(44),i()()(),a(45,"div",69)(46,"h3",70),s(47,"Order Items"),i(),a(48,"div",71),u(49,U,10,5,"div",72),i()(),a(50,"div",73)(51,"div",74)(52,"span"),s(53,"Total Amount:"),i(),a(54,"span"),s(55),i()()(),a(56,"div",75)(57,"button",76),v("click",function(){x(e);let l=c();return f(l.printOrder(l.selectedOrder))}),g(58,"i",77),s(59,"Print "),i(),u(60,q,3,1,"button",78),i()()()()}if(o&2){let e=c();r(5),d("Order #",e.selectedOrder.id.split("-").pop(),""),r(10),d(" ",e.selectedOrder.customerName,""),r(4),d(" ",e.selectedOrder.tableNumber||"Takeaway",""),r(4),d(" ",e.selectedOrder.orderType,""),r(4),y(e.getStatusBadgeClass(e.selectedOrder.status)),r(),h(e.selectedOrder.status),r(7),d(" ",e.formatTime(e.selectedOrder.createdAt),""),r(4),d(" ",e.getElapsedTime(e.selectedOrder.createdAt),""),r(),p("ngIf",e.selectedOrder.estimatedReadyTime),r(4),d(" ",e.selectedOrder.items.length,""),r(5),p("ngForOf",e.selectedOrder.items),r(6),d("\u20B9",e.selectedOrder.totalAmount,""),r(5),p("ngIf",e.canMoveToNextStatus(e.selectedOrder))}}var K=class o{realtimeService=_(N);mockDataService=_(D);subscriptions=[];currentTime="";activeStatus="all";activeStatusLabel="All Orders";selectedOrder=null;orders=[];filteredOrders=[];orderStatuses=[{key:"all",label:"All Orders",icon:"fas fa-list",color:"bg-gray-500"},{key:"pending",label:"Pending",icon:"fas fa-clock",color:"bg-yellow-500"},{key:"confirmed",label:"Confirmed",icon:"fas fa-check-circle",color:"bg-blue-500"},{key:"preparing",label:"Preparing",icon:"fas fa-utensils",color:"bg-orange-500"},{key:"ready",label:"Ready",icon:"fas fa-check-double",color:"bg-green-500"}];ngOnInit(){this.initializeTime(),this.loadOrders(),this.setupRealtimeSubscriptions()}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}initializeTime(){let t=w(1e3).subscribe(()=>{this.currentTime=new Date().toLocaleTimeString("en-IN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})});this.subscriptions.push(t)}loadOrders(){this.orders=this.mockDataService.getKitchenDisplayOrders(),this.filterOrders()}setupRealtimeSubscriptions(){let t=this.realtimeService.newOrder$.subscribe(n=>{n&&(this.orders.unshift(n),this.filterOrders())});this.subscriptions.push(t);let e=this.realtimeService.orderUpdate$.subscribe(n=>{if(n){let l=this.orders.findIndex(m=>m.id===n.id);l!==-1&&(this.orders[l]=n,this.filterOrders())}});this.subscriptions.push(e)}setActiveStatus(t){this.activeStatus=t,this.activeStatusLabel=this.orderStatuses.find(e=>e.key===t)?.label||"All Orders",this.filterOrders()}filterOrders(){this.activeStatus==="all"?this.filteredOrders=this.orders.filter(t=>["pending","confirmed","preparing","ready"].includes(t.status)):this.filteredOrders=this.orders.filter(t=>t.status===this.activeStatus),this.filteredOrders.sort((t,e)=>{let n={pending:4,confirmed:3,preparing:2,ready:1},l=(n[e.status]||0)-(n[t.status]||0);return l!==0?l:new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()})}get activeOrdersCount(){return this.orders.filter(t=>["pending","confirmed","preparing","ready"].includes(t.status)).length}getOrdersByStatus(t){return t==="all"?this.orders.filter(e=>["pending","confirmed","preparing","ready"].includes(e.status)):this.orders.filter(e=>e.status===t)}getStatusButtonClass(t){let e="px-4 py-2 rounded-lg font-medium transition-colors flex items-center text-white text-sm";if(this.activeStatus===t)return`${e} bg-opacity-100 shadow-lg transform scale-105`;let l=this.orderStatuses.find(m=>m.key===t);return`${e} ${l?.color} bg-opacity-80 hover:bg-opacity-100`}getStatusCountClass(t){let e=this.getOrdersByStatus(t).length;return e===0?"bg-gray-600 text-gray-300":e<3?"bg-green-600 text-green-100":e<5?"bg-yellow-600 text-yellow-100":"bg-red-600 text-red-100"}getOrderCardClass(t){let e="transition-all duration-300 hover:shadow-xl transform hover:-translate-y-1",n=(Date.now()-new Date(t.createdAt).getTime())/6e4;return t.status==="confirmed"&&n>10?`${e} animate-pulse border-2 border-red-500`:e}getOrderHeaderClass(t){return{pending:"bg-yellow-500 text-white",confirmed:"bg-blue-500 text-white",preparing:"bg-orange-500 text-white",ready:"bg-green-500 text-white",served:"bg-purple-500 text-white",completed:"bg-gray-500 text-white"}[t.status]||"bg-gray-500 text-white"}getPriorityBadgeClass(t){let e=(Date.now()-new Date(t.createdAt).getTime())/6e4;return e>15?"bg-red-600 text-white":e>10?"bg-orange-600 text-white":"bg-gray-600 text-white"}getOrderPriority(t){let e=(Date.now()-new Date(t.createdAt).getTime())/6e4;return e>15?"URGENT":e>10?"HIGH":e>5?"MEDIUM":"NORMAL"}formatTime(t){return new Date(t).toLocaleTimeString("en-IN",{hour12:!1,hour:"2-digit",minute:"2-digit"})}getElapsedTime(t){let e=Date.now(),n=new Date(t).getTime(),l=e-n,m=Math.floor(l/(1e3*60)),S=Math.floor(l%(1e3*60)/1e3);return m>0?`${m}m ${S}s`:`${S}s`}canMoveToNextStatus(t){let e=["pending","confirmed","preparing","ready"],n=e.indexOf(t.status);return n!==-1&&n<e.length-1}getNextStatus(t){let e=["pending","confirmed","preparing","ready"],n=e.indexOf(t);return n!==-1&&n<e.length-1?e[n+1]:t}getNextStatusLabel(t){return{pending:"Confirm",confirmed:"Start Prep",preparing:"Mark Ready"}[t]||"Update"}updateOrderStatus(t,e){let n=this.orders.findIndex(l=>l.id===t.id);n!==-1&&(this.orders[n].status=e,this.orders[n].updatedAt=new Date,this.orders[n].items.forEach(l=>{l.status=e}),this.filterOrders(),e==="ready"&&this.deductInventoryForOrder(t),this.realtimeService.triggerTestNotification())}deductInventoryForOrder(t){t.items.forEach(e=>{let n=this.mockDataService.getRecipeByMenuItemId(e.menuItemId);n&&n.ingredients.forEach(l=>{let m=l.quantity*e.quantity;this.mockDataService.updateInventoryStock(l.ingredientId,m)})})}markOrderServed(t){this.updateOrderStatus(t,"served")}viewOrderDetails(t){this.selectedOrder=t}closeOrderDetails(){this.selectedOrder=null}printOrder(t){console.log("Printing order:",t),alert(`Printing order ${t.id}...`)}getStatusBadgeClass(t){let e={pending:"px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800",confirmed:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800",preparing:"px-2 py-1 text-xs rounded-full bg-orange-100 text-orange-800",ready:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-800",served:"px-2 py-1 text-xs rounded-full bg-purple-100 text-purple-800",completed:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800"};return e[t]||e.pending}trackByOrderId(t,e){return e.id}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=k({type:o,selectors:[["app-kitchen-display"]],standalone:!0,features:[C],decls:8,vars:5,consts:[[1,"flex-1","bg-gray-100","dark:bg-gray-900","p-4","min-h-screen"],[1,"max-w-full"],[1,"mb-6","flex","flex-wrap","gap-2"],[3,"class","click",4,"ngFor","ngForOf"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-4"],["class","rounded-xl shadow-lg overflow-hidden",3,"class",4,"ngFor","ngForOf","ngForTrackBy"],["class","col-span-full flex items-center justify-center py-16",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",4,"ngIf"],[3,"click"],[1,"mr-2"],[1,"ml-2","px-2","py-0.5","rounded-full","text-xs"],[1,"rounded-xl","shadow-lg","overflow-hidden"],[1,"p-4","border-b"],[1,"flex","items-center","justify-between","mb-2"],[1,"flex","items-center","space-x-2"],[1,"text-lg","font-bold"],[1,"px-2","py-0.5","rounded-full","text-xs","font-medium"],[1,"text-right"],[1,"text-sm","opacity-90"],[1,"font-semibold"],[1,"flex","items-center","justify-between","text-sm"],[1,"font-mono"],[1,"mt-2","flex","items-center","justify-between"],[1,"fas","fa-clock","text-white/70"],[1,"font-mono","text-sm"],["class","text-xs",4,"ngIf"],[1,"p-4","bg-white","dark:bg-gray-800"],[1,"space-y-2","max-h-32","overflow-y-auto"],["class","flex items-center justify-between py-1",4,"ngFor","ngForOf"],[1,"mt-3","pt-3","border-t","border-gray-200","dark:border-gray-700"],[1,"flex","items-center","justify-between","font-semibold"],[1,"text-xs","text-gray-500"],[1,"p-4","bg-gray-50","dark:bg-gray-700","border-t","border-gray-200","dark:border-gray-600"],[1,"flex","items-center","justify-between"],["class","px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors text-sm font-medium",3,"click",4,"ngIf"],["class","px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors text-sm font-medium",3,"click",4,"ngIf"],[1,"flex","items-center","space-x-1"],["title","View Details",1,"p-2","text-gray-600","hover:text-gray-800","dark:text-gray-400","dark:hover:text-gray-200","transition-colors",3,"click"],[1,"fas","fa-eye"],["title","Print Order",1,"p-2","text-gray-600","hover:text-gray-800","dark:text-gray-400","dark:hover:text-gray-200","transition-colors",3,"click"],[1,"fas","fa-print"],[1,"text-xs"],[1,"flex","items-center","justify-between","py-1"],[1,"flex-1"],[1,"font-medium","text-sm"],["class","text-xs text-orange-600 dark:text-orange-400 mt-1",4,"ngIf"],[1,"text-sm","font-medium"],[1,"text-xs","text-orange-600","dark:text-orange-400","mt-1"],[1,"fas","fa-exclamation-triangle","mr-1"],[1,"px-4","py-2","bg-green-500","hover:bg-green-600","text-white","rounded-lg","transition-colors","text-sm","font-medium",3,"click"],[1,"fas","fa-check","mr-1"],[1,"px-4","py-2","bg-blue-500","hover:bg-blue-600","text-white","rounded-lg","transition-colors","text-sm","font-medium",3,"click"],[1,"fas","fa-utensils","mr-1"],[1,"col-span-full","flex","items-center","justify-center","py-16"],[1,"text-center"],[1,"w-16","h-16","bg-gray-200","dark:bg-gray-700","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],[1,"fas","fa-utensils","text-2xl","text-gray-400"],[1,"text-lg","font-medium","text-gray-900","dark:text-white","mb-2"],[1,"text-gray-500","dark:text-gray-400"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-2xl","max-w-2xl","w-full","max-h-[90vh]","overflow-y-auto"],[1,"p-6"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold"],[1,"p-2","hover:bg-gray-100","dark:hover:bg-gray-700","rounded-lg",3,"click"],[1,"fas","fa-times"],[1,"grid","grid-cols-2","gap-6","mb-6"],[1,"font-semibold","mb-2"],[4,"ngIf"],[1,"mb-6"],[1,"font-semibold","mb-3"],[1,"space-y-3"],["class","flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",4,"ngFor","ngForOf"],[1,"border-t","pt-4"],[1,"flex","items-center","justify-between","text-lg","font-bold"],[1,"flex","items-center","justify-end","space-x-3","mt-6"],[1,"px-4","py-2","bg-gray-500","hover:bg-gray-600","text-white","rounded-lg","transition-colors",3,"click"],[1,"fas","fa-print","mr-2"],["class","px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors",3,"click",4,"ngIf"],[1,"flex","items-center","justify-between","p-3","bg-gray-50","dark:bg-gray-700","rounded-lg"],[1,"font-medium"],["class","text-sm text-orange-600 dark:text-orange-400 mt-1",4,"ngIf"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-orange-600","dark:text-orange-400","mt-1"],[1,"px-4","py-2","bg-green-500","hover:bg-green-600","text-white","rounded-lg","transition-colors",3,"click"],[1,"fas","fa-check","mr-2"]],template:function(e,n){e&1&&(a(0,"main",0)(1,"div",1)(2,"div",2),u(3,M,5,8,"button",3),i(),a(4,"div",4),u(5,j,43,19,"div",5)(6,P,8,1,"div",6),i(),u(7,z,61,14,"div",7),i()()),e&2&&(r(3),p("ngForOf",n.orderStatuses),r(2),p("ngForOf",n.filteredOrders)("ngForTrackBy",n.trackByOrderId),r(),p("ngIf",n.filteredOrders.length===0),r(),p("ngIf",n.selectedOrder))},dependencies:[T,I,E]})};export{K as KitchenDisplayComponent};
