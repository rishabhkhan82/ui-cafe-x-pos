import{a as b,b as h,e as p,l as m}from"./chunk-EUT5JVHI.js";import{a as g}from"./chunk-LVGQPJ4G.js";import{T as o,Y as u,k as c}from"./chunk-7EVLTLXU.js";var l=class i{constructor(e){this.http=e}getData(e,r,t){let s=this.buildUrl(e),n=this.buildParams(r),a=this.buildHeaders(t);return this.http.get(s,{headers:a,params:n})}postData(e,r,t){let s=this.buildUrl(e),n=this.buildHeaders(t);return this.http.post(s,r,{headers:n})}putData(e,r,t,s){let n=this.buildUrl(e,s),a=this.buildHeaders(t);return this.http.put(n,r,{headers:a})}patchData(e,r,t,s){let n=this.buildUrl(e,s),a=this.buildHeaders(t);return this.http.patch(n,r,{headers:a})}deleteData(e,r,t){let s=this.buildUrl(e,t),n=this.buildHeaders(r);return this.http.delete(s,{headers:n})}uploadFile(e,r,t,s){let n=this.buildUrl(e),a=new FormData;a.append("file",r),t&&Object.keys(t).forEach(d=>{a.append(d,t[d])});let f=this.buildHeaders(s,!0);return this.http.post(n,a,{headers:f})}bulkCreate(e,r,t){let s=this.buildUrl(`${e}/bulk`),n=this.buildHeaders(t);return this.http.post(s,{items:r},{headers:n})}bulkUpdate(e,r,t){let s=this.buildUrl(`${e}/bulk`),n=this.buildHeaders(t);return this.http.put(s,{items:r},{headers:n})}bulkDelete(e,r,t){let s=this.buildUrl(`${e}/bulk`),n=this.buildHeaders(t);return this.http.request("delete",s,{headers:n,body:{ids:r}})}buildUrl(e,r){let t=`/api/${e}`;return r!==void 0&&(t+=`/${r}`),t}buildParams(e){let r=new h;return e&&Object.keys(e).forEach(t=>{let s=e[t];s!=null&&(r=r.set(t,s.toString()))}),r}buildHeaders(e,r=!1){let t=new b;return r||(t=t.set("Content-Type","application/json")),e&&Object.keys(e).forEach(s=>{t=t.set(s,e[s])}),t}getMenuItems(e){return this.getData("menu",e)}createMenuItem(e){return this.postData("menu",e)}updateMenuItem(e,r){return this.putData("menu",r,{},e)}deleteMenuItem(e){return this.deleteData("menu",{},e)}getOrders(e){return this.getData("orders",e)}createOrder(e){return this.postData("orders",e)}updateOrderStatus(e,r){return this.patchData("orders",{status:r},{},e)}getInventory(e){return this.getData("inventory",e)}updateStock(e,r){return this.patchData("inventory",{quantity:r},{},e)}getUsers(e){return this.getData("users",e)}createUser(e){return this.postData("users",e)}static \u0275fac=function(r){return new(r||i)(u(p))};static \u0275prov=o({token:i,factory:i.\u0275fac,providedIn:"root"})};var v=class i{constructor(e,r,t){this.router=e;this.mockDataService=r;this.crudService=t;this.mockDataService.getUsers().subscribe(s=>{this.users=s})}currentUserSubject=new c(null);currentUser$=this.currentUserSubject.asObservable();currentUser=null;users=[];login(e,r){let t=this.users.find(s=>s.username===e&&s.password===r);return t?(this.currentUser=t,sessionStorage.setItem("currentUser",JSON.stringify(t)),this.currentUserSubject.next(t),!0):!1}loginApi(e){return this.crudService.postData("auth/login",e)}logout(){this.currentUser=null,sessionStorage.removeItem("currentUser"),this.currentUserSubject.next(null),this.router.url.startsWith("/admin")?this.router.navigate(["/admin/login"]):this.router.navigate(["/customer/login"])}getCurrentUser(){if(!this.currentUser){let e=sessionStorage.getItem("currentUser");e&&(this.currentUser=JSON.parse(e),this.currentUserSubject.next(this.currentUser))}return this.currentUser}setCurrentUser(e){this.currentUser=e,sessionStorage.setItem("currentUser",JSON.stringify(e)),this.currentUserSubject.next(e)}isLoggedIn(){return this.getCurrentUser()!==null}getUserRole(){let e=this.getCurrentUser();return e?e.role:null}getDummyCredentials(){return this.users.map(e=>({role:e.role,username:e.username,password:e.password}))}static \u0275fac=function(r){return new(r||i)(u(m),u(g),u(l))};static \u0275prov=o({token:i,factory:i.\u0275fac,providedIn:"root"})};export{v as a};
